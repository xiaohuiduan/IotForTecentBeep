[TOC]

# è…¾è®¯IOTä¹‹æ ‘è“æ´¾ç‰©è”ç½‘è®¾å¤‡

æœ¬æ¬¡å®éªŒçš„ç›®çš„æ˜¯å°†**æ ‘è“æ´¾**è®¾ç½®ä¸ºä¸€ä¸ª**ç‰©è”ç½‘ç»ˆç«¯**ï¼Œé€šè¿‡å¾®ä¿¡å°ç¨‹åºå¯ä»¥æ§åˆ¶æ ‘è“æ´¾ï¼Œå®ç°èœ‚é¸£å™¨çš„å¼€å…³ã€‚

å¾®ä¿¡å°ç¨‹åºç•Œé¢å¦‚ä¸‹æ‰€ç¤ºï¼Œç‚¹å‡»è¿™ä¸ªå¼€å…³ï¼Œå°±å¯ä»¥æ§åˆ¶èœ‚é¸£å™¨ã€‚

![](imgs/image-20210110160709316-1610359469526.png)

é¡¹ç›®åœ°å€ï¼šhttps://github.com/xiaohuiduan/IotForTecentBeep



## æ¶æ„å›¾

ä¸€å›¾èƒœåƒè¨€ï¼š

![](imgs/struct.png)



## ç¡¬ä»¶é…ç½®

1. æ ‘è“æ´¾
2. èœ‚é¸£å™¨

åœ¨è¿™é‡Œæˆ‘å°†æ ‘è“æ´¾æ¥çš„æ˜¯`GPIO_00`ï¼Œä½¿ç”¨çš„æ ‘è“æ´¾æ˜¯æ ‘è“æ´¾4Bç‰ˆæœ¬ã€‚ä¸åŒçš„æ ‘è“æ´¾çš„GPIOæ¥å£å¯èƒ½ä¸åŒï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€è¦æŒ‰æƒ…å†µè€ƒè™‘ã€‚

å®ç‰©å›¾å¦‚ä¸‹æ‰€ç¤ºï¼ŒVCCâ€”â€”3.3V ï¼ŒGND â€”â€”GNDï¼ŒIOâ€”â€”GPIO_00ï¼ˆä½ç”µå¹³è§¦å‘ï¼‰

![](imgs/image-20210111001159601-1610359469527.png)



## è½¯ä»¶é…ç½®

ç¼–ç¨‹è¯­è¨€ä½¿ç”¨çš„æ˜¯Javaï¼Œä¹Ÿå°±æ˜¯è¯´å°†ä½¿ç”¨Javaå®ç°è…¾è®¯äº‘IOTå¹³å°çš„è¿æ¥å’Œæ ‘è“æ´¾GPIOå£çš„æ§åˆ¶ã€‚ä½¿ç”¨çš„IDEæ˜¯`IntelliJ IDEA`ã€‚



## Tecent IOT å¼€å‘å¹³å°çš„ä½¿ç”¨

Tecent IOTå¼€å‘å¹³å°çš„å®˜æ–¹å‚è€ƒæ–‡æ¡£ç½‘å€ï¼š[https://cloud.tencent.com/document/product/1081](https://cloud.tencent.com/document/product/1081)ï¼Œä¸è¿‡ä¸ªäººè§‰å¾—å…¶æ–‡æ¡£å¯¹äºJava SDKçš„æè¿°ä¸å¤Ÿè¯¦ç»†ï¼Œå»ºè®®å»çœ‹å…¶ [Demo ](https://github.com/tencentyun/iot-device-java/tree/master/explorer/explorer-device-android)æºç æ‰èƒ½æ˜ç™½å…¶å·¥ä½œæµç¨‹ã€‚

è…¾è®¯äº‘IOTå¼€å‘å¹³å°çš„é¡¹ç›®ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼šåˆ†ä¸ºä¸¤å±‚â€”â€”`é¡¹ç›®` å’Œ `äº§å“`ã€‚åœ¨ä½¿ç”¨å…¶å¹³å°çš„æ—¶å€™ï¼Œæ—¢éœ€è¦åˆ›å»ºprojectï¼Œä¹Ÿéœ€è¦åˆ›å»ºproductã€‚

![](imgs/image-20210110204928555-1610359469527.png)

> æˆ‘ä»¬å¯ä»¥å°†**é¡¹ç›®**ç†è§£ä¸ºæ™ºèƒ½å®¶å±…æ•´ä¸ªç³»ç»Ÿï¼Œå› æ­¤åœ¨é¡¹ç›®ä¸­æœ‰å¾ˆå¤š**äº§å“**ï¼Œæ¯”å¦‚è¯´æ™ºèƒ½ç©ºè°ƒï¼Œæ™ºèƒ½æŠ¥è­¦å™¨ç­‰ç­‰äº§å“ã€‚è€Œåœ¨ç©ºè°ƒä¸­æœ‰æ¸©åº¦ã€æ¹¿åº¦ç­‰**å±æ€§**ï¼ŒåŒæ—¶ä¹Ÿæœ‰ç€å¼€å…³ç­‰**æ§åˆ¶å™¨**ã€‚
>
> è€Œåœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œé¡¹ç›®åç§°æ˜¯**ç‰©è”ç½‘å®è®­**ï¼Œäº§å“åä¸º**æ ‘è“æ´¾**ï¼Œä½†æ˜¯æ ‘è“æ´¾åªæœ‰ä¸€ä¸ª**åŠŸèƒ½**â€”â€”æ§åˆ¶èœ‚é¸£å™¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ²¡æœ‰**å±æ€§**ï¼Œåªæœ‰**æ§åˆ¶å™¨**ã€‚



### æ–°å»ºé¡¹ç›®

æ‰“å¼€ç½‘å€ï¼š[https://console.cloud.tencent.com/iotexplorer](https://console.cloud.tencent.com/iotexplorer)æ–°å»ºé¡¹ç›®ï¼Œé¡¹ç›®åç§°éšæ„å°±è¡Œï¼Œåˆ›å»ºå¥½é¡¹ç›®åï¼Œè¿›å…¥é¡¹ç›®ï¼Œç„¶ååˆ›å»ºäº§å“ã€‚

![](imgs/image-20210110162327104-1610359469527.png)

### æ–°å»ºäº§å“

åˆ›å»ºäº§å“çš„é€‰é¡¹å¦‚ä¸‹ï¼š

- è®¾å¤‡ï¼šå› ä¸ºæˆ‘ä»¬æ˜¯å‡†å¤‡å°†æ ‘è“æ´¾ä½œä¸ºä¸€å°è®¾å¤‡æ¥ä½¿ç”¨çš„ï¼Œå› æ­¤ï¼Œåº”è¯¥é€‰æ‹©**â€è®¾å¤‡â€œ**ï¼Œå½“ç„¶ï¼Œå¦‚æœæ˜¯å‡†å¤‡å°†å®ƒä½œä¸ºç½‘å…³ï¼Œåˆ™çœ‹ç€é€‰å°±è¡Œäº†ã€‚
- è®¤è¯æ–¹å¼ï¼šè®¤è¯æ–¹å¼é€‰æ‹©å¯†é’¥è®¤è¯ï¼Œè¿™æ ·åœ¨ä»£ç ä¸­é—´ç›´æ¥å†™è®¾å¤‡çš„å¯†ç å°±è¡Œï¼Œæ¯”è¯ä¹¦ç¨å¾®æ–¹ä¾¿ä¸€ç‚¹ï¼ˆä¸è¿‡å®é™…ä¸Šè¯ä¹¦æ–¹ä¾¿ä¸€ç‚¹ï¼‰ã€‚
- æ•°æ®åè®®ï¼šä½¿ç”¨æ•°æ®æ¨¡æ¿å³å¯ã€‚

![](imgs/image-20210110163410393-1610359469527.png)

### æ·»åŠ è‡ªå®šä¹‰åŠŸèƒ½

ç‰©è”ç½‘è®¾å¤‡ï¼Œä¹‹æ‰€ä»¥å«ç‰©è”ç½‘ï¼Œæ˜¯å› ä¸ºå¤§å®¶æƒ³æŠŠä¼ æ„Ÿå™¨è·å¾—çš„æ•°æ®æ”¾åœ¨äº‘ç«¯ï¼Œæˆ–è€…é€šè¿‡äº‘ç«¯å»æ§åˆ¶ç‰©è”ç½‘è®¾å¤‡ã€‚é‚£ä¹ˆæ”¾ä»€ä¹ˆæ•°æ®ï¼Œæ§åˆ¶ä»€ä¹ˆåŠŸèƒ½ï¼Œåˆ™éœ€è¦æˆ‘ä»¬å»å®šä¹‰ã€‚è¿™é‡Œé€‰æ‹©æ§åˆ¶æ ‘è“æ´¾ä¸Šé¢çš„èœ‚é¸£å™¨ï¼Œå› æ­¤åªéœ€è¦å®šä¹‰èœ‚é¸£å™¨å³å¯ã€‚

åœ¨è…¾è®¯IOTä¸­ï¼Œå¯ä»¥ä½¿ç”¨`æ–°å»ºåŠŸèƒ½`å®šä¹‰è¿™äº›åŠŸèƒ½ã€‚é€‰æ‹©**å±æ€§**ï¼Œæ•°æ®ç±»å‹é€‰æ‹©**å¸ƒå°”å‹**ï¼ˆå› ä¸ºåªæœ‰æ§åˆ¶èœ‚é¸£å™¨çš„å¼€/å…³ï¼‰ã€‚è¯·è®°ä½è¿™ä¸ªæ ‡è¯†ç¬¦`beep_switch`ï¼Œè¿™ä¸ªå°†åœ¨åé¢çš„ä»£ç ä¸­ç”¨åˆ°ã€‚

![](imgs/image-20210110163600417-1610359469527.png)

å…³äºåŠŸèƒ½ç±»å‹çš„ä¸åŒï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„è¡¨æ ¼ã€‚ï¼ˆä¸è¿‡åœ¨ä¸ªäººçœ‹æ¥ï¼Œåœ¨ä»–çš„å®˜æ–¹ Demo ä¸­ï¼Œæ— è®ºæ˜¯ç‰©è”è®¾å¤‡çš„æ•°æ®ï¼ˆæ¯”å¦‚è¯´æ¸©åº¦æ¹¿åº¦ï¼‰ï¼Œè¿˜æ˜¯ç‰©è”ç½‘çš„æ§åˆ¶ï¼ˆæ¯”å¦‚è¯´ç¯çš„å¼€å…³ï¼‰ï¼Œå®ƒéƒ½å®šä¹‰æˆä¸ºäº†å±æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå°½ç®¡ **èœ‚é¸£å™¨çš„å¼€å…³** æ˜¯äººä¸ºä¸‹å‘çš„æ§åˆ¶ï¼Œä½†æ˜¯è¿˜æ˜¯å®šä¹‰ä¸ºå±æ€§ã€‚è‡³äºäº‹ä»¶å’Œè¡Œä¸ºæœ‰ä»€ä¹ˆä½œç”¨ï¼Œæˆ‘ä¹Ÿä¸æ¸…æ¥šâ€¦â€¦)

> ä»¥ä¸‹æ¥è‡ªå®˜æ–¹æ–‡æ¡£
>
> | åŠŸèƒ½å…ƒç´  | åŠŸèƒ½æè¿°                                                     | åŠŸèƒ½æ ‡è¯†ç¬¦   |
> | :------- | :----------------------------------------------------------- | :----------- |
> | å±æ€§     | ç”¨äºæè¿°è®¾å¤‡çš„å®æ—¶çŠ¶æ€ï¼Œæ”¯æŒè¯»å–å’Œè®¾ç½®ï¼Œå¦‚æ¨¡å¼ã€äº®åº¦ã€å¼€å…³ç­‰ã€‚ | PropertiesId |
> | äº‹ä»¶     | ç”¨äºæè¿°è®¾å¤‡è¿è¡Œæ—¶çš„äº‹ä»¶ï¼ŒåŒ…æ‹¬å‘Šè­¦ã€ä¿¡æ¯å’Œæ•…éšœç­‰ä¸‰ç§äº‹ä»¶ç±»å‹ï¼Œå¯æ·»åŠ å¤šä¸ªè¾“å‡ºå‚æ•°ï¼Œå¦‚ç¯å¢ƒä¼ æ„Ÿå™¨æ£€æµ‹åˆ°ç©ºæ°”è´¨é‡å¾ˆå·®ï¼Œç©ºè°ƒå¼‚å¸¸å‘Šè­¦ç­‰ã€‚ | EventId      |
> | è¡Œä¸º     | ç”¨äºæè¿°å¤æ‚çš„ä¸šåŠ¡é€»è¾‘,å¯æ·»åŠ å¤šä¸ªè°ƒç”¨å‚æ•°å’Œè¿”å›å‚æ•°,ç”¨äºè®©è®¾å¤‡æ‰§è¡ŒæŸé¡¹ç‰¹å®šçš„ä»»åŠ¡ï¼Œä¾‹å¦‚ï¼Œå¼€é”åŠ¨ä½œéœ€è¦çŸ¥é“æ˜¯å“ªä¸ªç”¨æˆ·åœ¨ä»€ä¹ˆæ—¶é—´å¼€é”ï¼Œé”çš„çŠ¶æ€å¦‚ä½•ç­‰ã€‚ | ActionId     |



ç‚¹å‡»ä¸‹ä¸€æ­¥ï¼Œè¿›å…¥è®¾å¤‡å¼€å‘ã€‚

![](imgs/image-20210110164115396-1610359469527.png)



### è®¾å¤‡å¼€å‘

å› ä¸ºè¿™é‡Œä½¿ç”¨çš„æ˜¯Java SDKè¿›è¡Œå¼€å‘ï¼Œæ²¡æœ‰ä½¿ç”¨æ¨¡ç»„ä¹Ÿæ²¡æœ‰åŸºäºOSå¼€å‘ï¼Œå› æ­¤ç›´æ¥ç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚

![image-20210106165342612](imgs/image-20210106165342612-1610359469527.png)

ç‚¹å‡»ä¸‹ä¸€æ­¥å°±åˆ°äº†å¾®ä¿¡å°ç¨‹åºé…ç½®ã€‚

### å¾®ä¿¡å°ç¨‹åºé…ç½®

è…¾è®¯IOTå¹³å°ç›¸æ¯”è¾ƒäºå…¶ä»–å¹³å°ï¼Œæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç‰¹ç‚¹å°±æ˜¯å¯ä»¥å¾ˆå¥½çš„æ”¯æŒå°ç¨‹åºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å¼€å‘çš„é˜¶æ®µï¼Œå°±å¯ä»¥ä½¿ç”¨å°ç¨‹åºå»éªŒè¯è®¾å¤‡çš„åŠŸèƒ½ã€‚å¹¶ä¸”è¿™ä¸ªå¾®ä¿¡å°ç¨‹åºä¸éœ€è¦è‡ªå·±å†™æ ·å¼ä»£ç ï¼Œåªéœ€è¦è¿›è¡Œç®€å•çš„é…ç½®ï¼Œå°±å¯ä»¥ç›´æ¥ä»å°ç¨‹åºä¸Šé¢çœ‹åˆ°ç‰©è”ç½‘è®¾å¤‡çš„æ•°æ®ã€‚

å› ä¸ºè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ•°æ®å¾ˆç®€å•ï¼Œåªæœ‰å¼€å…³ï¼Œæ‰€ä»¥éšä¾¿é…ç½®ä¸€ä¸‹é¢æ¿å³å¯ã€‚

![](imgs/image-20210106165709853-1610359469527.png)



#### é¢æ¿é…ç½®

è¿™é‡Œé¢æ¿ç±»å‹é€‰æ‹©**æ ‡å‡†é¢æ¿**ï¼Œç®€å•çš„é…ç½®ä¸€ä¸‹å¼€å…³å³å¯ï¼Œæ•ˆæœå›¾å¦‚å³å›¾æ‰€ç¤ºã€‚

![](imgs/image-20210110164635715-1610359469527.png)

ä¿å­˜é€€å‡ºä¹‹åï¼Œå°±è¿›å…¥åˆ°æ–°å»ºè®¾å¤‡åŠŸèƒ½é¡µé¢ã€‚

### æ–°å»ºè®¾å¤‡

>  æ–°å»ºè®¾å¤‡`çš„æ„ä¹‰ï¼šåˆ›å»ºä¸€ä¸ªè®¾å¤‡ä»£è¡¨å¯åŠ¨äº†ä¸€ä¸ªè´¦å·ï¼ˆè¿™ä¸ªè®¾å¤‡ä¼šæä¾›ä¸€ä¸ªå¯†é’¥ï¼‰ï¼Œæˆ‘ä»¬çš„è®¾å¤‡ä½¿ç”¨è¿™ä¸ªå¯†é’¥ï¼Œå°±å¯ä»¥è®©æˆ‘ä»¬çš„è®¾å¤‡è¿æ¥è…¾è®¯äº‘IOTå¹³å°è¿›è¡Œæ•°æ®äº¤äº’ã€‚
>
>  ä»ç°å®æ„ä¹‰æ¥è¯´ï¼Œå°±æ˜¯æˆ‘æ‰‹ä¸­æœ‰ä¸€ä¸ªæ ‘è“æ´¾ï¼Œæˆ‘éœ€è¦è®©å®ƒè¿æ¥è…¾è®¯äº‘IOTå¹³å°ï¼Œå°±éœ€è¦è´¦å·å¯†ç ï¼Œæ‰€ä»¥å°±éœ€è¦åˆ›å»ºä¸€ä¸ªè®¾å¤‡ã€‚

æ–°å»ºè®¾å¤‡çš„æ­¥éª¤å¦‚ä¸‹æ‰€ç¤ºï¼š

![](imgs/image-20210110165643637-1610359469527.png)

### ä½¿ç”¨è®¾å¤‡

ç‚¹å‡» **my_pi** ï¼Œè¿›å…¥è®¾å¤‡ç®¡ç†ã€‚

![](imgs/image-20210110165723711-1610359469527.png)

è®¾å¤‡ç®¡ç†ç•Œé¢å¦‚ä¸‹æ‰€ç¤ºï¼š

- è®¾å¤‡ä¿¡æ¯ï¼šè¿™é‡Œé¢æ˜¯è®¾å¤‡çš„ä¸€äº›åŸºæœ¬å±æ€§ï¼Œå…¶ä¸­é€šè¿‡è®¾å¤‡``åç§°``ï¼Œ`è®¾å¤‡å¯†é’¥`ï¼Œå’Œ`äº§å“ID`å°±å¯ä»¥å”¯ä¸€å®šä½ä¸€ä¸ª`è®¾å¤‡`ï¼Œç„¶åå¯¹å…¶è¿›è¡Œæ“ä½œã€‚

- è®¾å¤‡æ—¥å¿—ï¼šè®¾å¤‡æ—¥å¿—é‡Œé¢ä¿å­˜ç€è®¾å¤‡çš„ä¸Šè¡Œå’Œä¸‹è¡Œæ•°æ®ã€‚
- åœ¨çº¿è°ƒè¯•ï¼šé€šè¿‡åœ¨çº¿è°ƒè¯•ï¼Œå¯ä»¥æ¨¡æ‹Ÿè®¾å¤‡çš„è¡Œä¸ºï¼Œæˆ–è€…å¯¹è®¾å¤‡ä¸‹å‘æ§åˆ¶å‘½ä»¤ã€‚

![](imgs/image-20210110165755939-1610359469527.png)

### åœ¨çº¿è°ƒè¯•

å¯ä»¥ä½¿ç”¨åœ¨çº¿çš„è°ƒè¯•åŠŸèƒ½å¯¹ç‰©è”ç½‘è®¾å¤‡è¿›è¡ŒåŠŸèƒ½ä¸‹å‘ã€‚ï¼ˆæ¯”å¦‚è¯´ä¸‹å‘å¼€å…³æ•°æ®ï¼Œæ§åˆ¶èœ‚é¸£å™¨çš„å¼€å…³ï¼‰

![](imgs/image-20210110223500195-1610359469527.png)

### è®¾å¤‡æ—¥å¿—

å¯ä»¥åœ¨è®¾å¤‡ä¸­çœ‹åˆ°ç‰©è”ç½‘è®¾å¤‡ä¸äº‘å¹³å°ä¹‹é—´çš„ä¸Šè¡Œå’Œä¸‹è¡Œæ•°æ®ã€‚

![](imgs/image-20210110223846544-1610359469527.png)

ğŸ†—ï¼Œä»¥ä¸Šçš„æ‰€æœ‰å°±æ˜¯è…¾è®¯IOTå¹³å°çš„ä»‹ç»ï¼Œé€šè¿‡ä¸Šé¢çš„æ“ä½œï¼Œå°±å¯ä»¥åˆ›å»ºä¸€ä¸ªè®¾å¤‡ï¼Œè·å¾—å…¶nameï¼Œkeyï¼Œidï¼Œç„¶åå¯¹å…¶è¿›è¡Œå¼€å‘ã€‚

## æ ‘è“æ´¾Javaå¼€å‘

é’ˆå¯¹äºæ ‘è“æ´¾å¼€å‘ï¼Œç›¸ä¿¡å¤§å®¶å¬è¿‡æœ€å¤šçš„éƒ½æ˜¯Pythonå¼€å‘ï¼Œä½¿ç”¨Pythonå»æ§åˆ¶æ ‘è“æ´¾çš„GPIOå£ï¼Œä½†æ˜¯ï¼Œå› ä¸ºè…¾è®¯æä¾›çš„å¹³å°æ²¡æœ‰Pythonçš„SDKï¼Œå› æ­¤ï¼Œåªèƒ½é€‰æ‹©Javaå»æ§åˆ¶æ ‘è“æ´¾çš„GPIOå£ã€‚

[Pi4j](https://pi4j.com/1.2/index.html)æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥æ§åˆ¶æ ‘è“æ´¾GPIOå£çš„è®¾å¤‡ã€‚å…³äºä½¿ç”¨å®‰è£…å¯ä»¥å»çœ‹[æ ‘è“æ´¾---JAVAæ“ä½œGPIO](https://www.jianshu.com/p/0584f8b01725)ï¼ˆä¸è¿‡åŸºæœ¬ä¸Šæ¯”è¾ƒæ–°çš„æ ‘è“æ´¾ç³»ç»Ÿéƒ½ä¸éœ€è¦å®‰è£…äº†ï¼‰ã€‚

å› ä¸ºæˆ‘ä»¬æ˜¯åœ¨Windowså¹³å°å¼€å‘ç„¶ååœ¨æ ‘è“æ´¾ä¸Šé¢è¿è¡ŒJavaç¨‹åºï¼ˆæ‰“åŒ…æˆjarè¿è¡Œï¼‰ï¼Œå› æ­¤éœ€è¦åœ¨æ ‘è“æ´¾ä¸Šé¢å®‰è£…Javaç¯å¢ƒï¼ˆä¸è¿‡ä¸€èˆ¬æ¥è¯´æ ‘è“æ´¾éƒ½è‡ªå¸¦äº†Javaç¯å¢ƒï¼‰ã€‚

### åˆ›å»ºé¡¹ç›®

ä½¿ç”¨IDEAåˆ›å»ºmavené¡¹ç›®ã€‚

![](imgs/image-20210110172651328-1610359469527.png)

é€šè¿‡ä¸Šè¿°æ“ä½œå°±åˆ›å»ºä¸€ä¸ªJava mavené¡¹ç›®ã€‚

### é…ç½®mavenæ–‡ä»¶

ç„¶åé…ç½®mavenæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯`pom.xml`ï¼Œåœ¨å…¶ä¸­å¯¼å…¥ä¾èµ–åº“ï¼Œä»¥åŠè¿›è¡Œé…ç½®ã€‚

![](imgs/image-20210110181811614-1610359469528.png)

å…·ä½“é…ç½®å¦‚ä¸‹ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <build>
        <plugins>
            <plugin>
                <artifactId>maven-assembly-plugin</artifactId>
                <configuration>
                    <appendAssemblyId>false</appendAssemblyId>
                    <descriptorRefs>
                        <descriptorRef>jar-with-dependencies</descriptorRef>
                    </descriptorRefs>
                    <archive>
                        <manifest>
                            <!--æ³¨æ„ï¼Œæ­¤å¤„å¿…é¡»æ˜¯main()æ–¹æ³•å¯¹åº”ç±»çš„å®Œæ•´è·¯å¾„  -->
                            <mainClass>Main</mainClass>
                        </manifest>
                    </archive>
                </configuration>
                <executions>
                    <execution>
                        <id>make-assembly</id>
                        <phase>package</phase>
                        <goals>
                            <goal>assembly</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
	
    <!--    ç”Ÿæˆçš„åŒ…å-->
    <groupId>org.example</groupId>
    <artifactId>IotForTecentBeep</artifactId>
    <version>1.0-SNAPSHOT</version>

    <!--    æ·»åŠ ä¾èµ–åº“-->
    <dependencies>
        <!--        è…¾è®¯IOTåº“-->
        <dependency>
            <groupId>com.tencent.iot.explorer</groupId>
            <artifactId>explorer-device-java</artifactId>
            <version>1.0.0</version>
        </dependency>
        <!--        æ ‘è“æ´¾GPIO åº“-->
        <dependency>
            <groupId>com.pi4j</groupId>
            <artifactId>pi4j-core</artifactId>
            <version>1.2</version>
        </dependency>


    </dependencies>

</project>
```



### é¡¹ç›®æ–‡ä»¶é…ç½®

åœ¨é¡¹ç›®çš„ç›®å½•ä¸‹é¢æ·»åŠ data.jsonæ–‡ä»¶ã€‚

![](imgs/image-20210110182824207-1610359469528.png)

data.jsonéœ€è¦å­˜æ”¾ä¸€äº›æ•°æ®ã€‚è¿™ä¸ªæ•°æ®å®é™…ä¸Šå°±æ˜¯**è‡ªå®šä¹‰åŠŸèƒ½çš„jsonæ•°æ®**ï¼Œä»é¡µé¢å¤åˆ¶ä¹‹åç²˜è´´åˆ°data.jsonæ–‡ä»¶ä¸­å³å¯ã€‚

![](imgs/image-20210110183125568-1610359469528.png)

### ä»£ç ç¼–å†™

ä½¿ç”¨Javaç¼–å†™ä»£ç ï¼Œå…·ä½“çš„è§£é‡Šå¯ä»¥çœ‹ä»£ç ä¸­é—´çš„æ³¨é‡Šã€‚ä¸è¿‡è¦æ³¨æ„ï¼Œéœ€è¦æ ¹æ®è‡ªå·±çš„è®¾å¤‡æƒ…å†µæ›´æ”¹å¦‚ä¸‹çš„ä¿¡æ¯ã€‚

![](imgs/image-20210110185422078-1610359469528.png)

åŒæ—¶ï¼Œåœ¨è¿™ä¸ªåœ°æ–¹éœ€è¦æ ¹æ®è‡ªå·±çš„æƒ…å†µä¿®æ”¹ã€‚ï¼ˆå°½ç®¡åœ¨äº‘å¹³å°ä¸­å®šä¹‰çš„æ˜¯å¸ƒå°”å‹æ•°æ®ï¼Œä½†æ˜¯å®é™…ä¸Šè…¾è®¯äº‘å‘é€è¿‡æ¥çš„æ˜¯intç±»å‹æ•°æ®ã€‚ï¼‰

![](imgs/image-20210110223237684-1610359469528.png)

åœ¨ä»£ç ä¸­è¦æ³¨æ„ï¼Œ**å¿…é¡»**å…ˆè®¢é˜…ï¼ˆä¹Ÿå°±æ˜¯æ‰§è¡Œ`subscribeTopic`å‡½æ•°ï¼‰ï¼Œæ‰èƒ½å¤Ÿè¿›è¡Œæ¥æ”¶åˆ°å¹³å°å‘é€è¿‡æ¥çš„æ•°æ®ã€‚

```java
import com.pi4j.io.gpio.*;
import com.tencent.iot.explorer.device.java.common.Status;
import com.tencent.iot.explorer.device.java.data_template.TXDataTemplateDownStreamCallBack;
import com.tencent.iot.explorer.device.java.mqtt.TXMqttActionCallBack;
import com.tencent.iot.explorer.device.java.server.samples.data_template.DataTemplateSample;
import org.eclipse.paho.client.mqttv3.IMqttToken;
import org.eclipse.paho.client.mqttv3.MqttMessage;
import org.json.JSONObject;

/**
 * @author XiaoHui
 */
public class Main {
    /**
     * IOTå¹³å°URL
     */
    public static String mBrokerURL = "ssl://iotcloud-mqtt.gz.tencentdevices.com:8883";
    /**
     * äº§å“ID
     */
    public static String mProductID = "64ONICJ3N8";
    /**
     * è®¾å¤‡åç§°
     */
    public static String mDevName = "my_pi";
    /**
     * è®¾å¤‡å¯†é’¥
     */
    public static String mDevPSK = "1ktYq8uojYiuJgX7iZxAoQ==";
    /**
     * å‚¨å­˜å±æ€§çš„jsonæ–‡ä»¶å
     */
    public static String mJsonFileName = "data.json";

    private static DataTemplateSample mDataTemplateSample;

    /**
     * è·å¾—GPIOçš„æ§åˆ¶å™¨
     */
    public static final GpioController gpio = GpioFactory.getInstance();
    /**
     * GPIOè¾“å‡ºï¼Œä½¿ç”¨GPIO_00 ,é»˜è®¤è¾“å‡ºä¸ºHigh
     */
    public static final GpioPinDigitalOutput beep = gpio.provisionDigitalOutputPin(RaspiPin.GPIO_00, "beep", PinState.HIGH);


    public static void main(String[] args) {
        // CallBack ä»£è¡¨çš„æ˜¯MQTTåè®®çš„å›è°ƒå‡½æ•°ï¼ŒMyDownCallbackä»£è¡¨çš„æ˜¯IOTå¹³å°ä¸‹å‘æ¶ˆæ¯çš„å›è°ƒ
        mDataTemplateSample = new DataTemplateSample(mBrokerURL, mProductID, mDevName, mDevPSK,
                null, null, new CallBack(), mJsonFileName, new MyDownCallback());
        // è¿›è¡Œè¿æ¥
        mDataTemplateSample.connect();
        // è¿›è¡Œè®¢é˜…ï¼Œåªæœ‰è®¢é˜…åï¼Œæ¶ˆæ¯æ‰èƒ½ä¸‹å‘ã€‚
        mDataTemplateSample.subscribeTopic();
        mDataTemplateSample.propertyClearControl();
    }

    /**
     * MQTTçš„å›è°ƒå‡½æ•°ï¼Œå¯ä»¥ä¸ç”¨ç®¡
     */
    public static class CallBack extends TXMqttActionCallBack {

        @Override
        public void onConnectCompleted(Status status, boolean reconnect, Object userContext, String msg) {

        }

        @Override
        public void onConnectionLost(Throwable cause) {

        }

        @Override
        public void onDisconnectCompleted(Status status, Object userContext, String msg) {
        }

        @Override
        public void onPublishCompleted(Status status, IMqttToken token, Object userContext, String errMsg) {
        }

        @Override
        public void onSubscribeCompleted(Status status, IMqttToken asyncActionToken, Object userContext, String errMsg) {
        }

        @Override
        public void onMessageReceived(final String topic, final MqttMessage message) {

        }

    }

    /**
     * å®ç°ä¸‹è¡Œæ¶ˆæ¯å¤„ç†çš„å›è°ƒæ¥å£
     */
    private static class MyDownCallback extends TXDataTemplateDownStreamCallBack {

        @Override
        public void onReplyCallBack(String msg) {

        }

        @Override
        public void onGetStatusReplyCallBack(JSONObject data) {


        }

        /**
         * åœ¨å¾®ä¿¡å°ç¨‹åºç‚¹å‡»å…³é—­æŒ‰é’®åï¼ŒIOTå¹³å°ä¼šå‘æ ‘è“æ´¾å‘é€å‘½ä»¤æ¶ˆæ¯ï¼Œæ­¤å‘½ä»¤æ¶ˆæ¯ä¼šåœ¨è¿™è¿™é‡Œè¿›è¡Œå›è°ƒ
         * beepæ˜¯ä½ç”µå¹³è§¦å‘ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼
         *
         * @param msg æ¥æ”¶åˆ°çš„æ¶ˆæ¯ã€‚
         * @return
         */
        @Override
        public JSONObject onControlCallBack(JSONObject msg) {

			// è·å¾—å¼€å…³çš„æ•°æ®ï¼Œbeep_switchæ˜¯å¼€å…³çš„æ ‡è¯†ç¬¦ã€‚å°½ç®¡æˆ‘ä»¬åœ¨äº‘å¹³å°ä¸­å®šä¹‰çš„æ˜¯å¸ƒå°”å‹æ•°æ®ï¼Œä½†æ˜¯å®é™…ä¸Šè…¾è®¯äº‘å‘é€è¿‡æ¥çš„æ˜¯intç±»å‹æ•°æ®ã€‚
            int power = msg.getInt("beep_switch");
            // æ‰“å¼€å¼€å…³
            if (power == 1) {
                beep.low();
                System.out.println("æ‰“å¼€");
            } else {
                // å…³é—­èœ‚é¸£å™¨
                beep.high();
                System.out.println("å…³é—­");
            }
            // è¿”å›æ¶ˆæ¯
            JSONObject result = new JSONObject();
            result.put("code", 0);
            result.put("status", "ok");
            return result;
        }

        @Override
        public JSONObject onActionCallBack(String actionId, JSONObject params) {
           return null;
        }
    }

}

```

### ä»£ç æ‰“åŒ…

å› ä¸ºæˆ‘ä»¬çš„ä»£ç æ˜¯åœ¨windowsä¸Šé¢ç¼–è¯‘çš„ï¼Œå› æ­¤éœ€è¦å°†å…¶ç¼–è¯‘æˆjaræ–‡ä»¶ï¼Œè¿™ä¸ªä¹Ÿå°±æ˜¯ä¹‹å‰é…ç½®`pom.xml`æ–‡ä»¶çš„åŸå› ã€‚IDEAä¸Šé¢ç¼–è¯‘è¿˜æ˜¯æŒºç®€å•çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](imgs/image-20210110202842411-1610359469528.png)

ç»è¿‡å¦‚ä¸Šçš„æ“ä½œæˆ‘ä»¬å°±å°†é¡¹ç›®ç¼–è¯‘æˆäº†jaråŒ…ï¼ŒjaråŒ…åœ¨targetç›®å½•ä¸‹ã€‚

![](imgs/image-20210111000936137-1610359469528.png)



## ç¨‹åºè¿è¡Œ

å°†ç¼–è¯‘å¥½çš„jaræ–‡ä»¶æ”¾åˆ°æ ‘è“æ´¾ä¸­ï¼Œä½¿ç”¨VNCæˆ–è€…XShellçš†å¯ã€‚ç„¶ååœ¨jaråŒ…æ–‡ä»¶ç›®å½•ä¸‹ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š

```bash
java -jar åŒ…å
```

æ­¤æ¬¡é¡¹ç›®ç”Ÿæˆçš„åŒ…åä¸º`IotForTecentBeep-1.0-SNAPSHOT.jar`ï¼Œå› æ­¤å‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š

![](imgs/image-20210111002518889-1610359469528.png)

å½“ç¨‹åºè¿è¡Œèµ·æ¥çš„æ—¶å€™ï¼Œå°±å¯ä»¥åœ¨å¾®ä¿¡å°ç¨‹åºæˆ–è€…åœ¨çº¿è°ƒè¯•å·¥å…·ä¸­å¯¹èœ‚é¸£å™¨è¿›è¡Œæ§åˆ¶ã€‚

### å¾®ä¿¡å°ç¨‹åºæ§åˆ¶

å‰é¢è¯´äº†ï¼Œå¯ä»¥æ˜¯ç”¨å¾®ä¿¡å°ç¨‹åºå¯¹å¼€å‘çš„ç‰©è”ç½‘è®¾å¤‡è¿›è¡Œå¼€å‘è°ƒè¯•ï¼Œç„¶ååœ¨å¦‚ä¸‹çš„é¡µé¢å¾—åˆ°è®¾å¤‡çš„äºŒç»´ç ã€‚

![](imgs/image-20210111003251622-1610359469528.png)

ç„¶åæ‰“å¼€â€è…¾è®¯è¿è¿â€œå°ç¨‹åºï¼Œå¯¹äºŒç»´ç è¿›è¡Œæ‰«æï¼Œå³å¯å°†è®¾å¤‡åŠ å…¥ã€‚

![](imgs/image-20210111003736085-1610359469528.png)

ç‚¹å‡»ä¸­é—´çš„æŒ‰é’®å°±å¯ä»¥å®ç°å¯¹èœ‚é¸£å™¨çš„æ§åˆ¶äº†ï¼ï¼ï¼

![](imgs/image-20210111003805707-1610359469528.png)





## æ€»ç»“

ç›¸æ¯”è¾ƒäºä¸Šä¸€ç¯‡[è…¾è®¯IOTå®‰å“å¼€å‘åˆæ¢](https://www.cnblogs.com/xiaohuiduan/p/14244343.html)ï¼Œè¿™ä¸€æ¬¡å®ç°æ¶ˆæ¯çš„ä¸‹å‘æ¥æ”¶æ§åˆ¶ã€‚ä¸è¿‡æœ‰ä¸€è¯´ä¸€ï¼Œå®˜æ–¹æ–‡æ¡£æ˜¯çœŸçš„å‘ï¼Œè¿ä¸€ä¸ªæ¯”è¾ƒè¯¦ç»†çš„è¯´æ˜æ–‡æ¡£éƒ½æ²¡æœ‰ï¼Œè¿˜å¾—è‡ªå·±ä¸€ä¸ªä¸€ä¸ªDebugï¼ŒæŸ¥çœ‹ä¸ºä»€ä¹ˆæ¶ˆæ¯å‘é€å¤±è´¥ï¼ŒæŸ¥çœ‹ä¸ºä»€ä¹ˆæ²¡æœ‰æ¥æ”¶åˆ°ä¸‹å‘çš„æ¶ˆæ¯â€¦â€¦

GitHubï¼š[https://github.com/xiaohuiduan/IotForTecentBeep](https://github.com/xiaohuiduan/IotForTecentBeep)

### å‚è€ƒ

1. [è…¾è®¯IOTå®‰å“å¼€å‘åˆæ¢](https://www.cnblogs.com/xiaohuiduan/p/14244343.html)

2. ç‰©è”ç½‘å¼€å‘å¹³å°ä½¿ç”¨æ–‡æ¡£ï¼š[ç‰©è”ç½‘å¼€å‘å¹³å° - æ–‡æ¡£ä¸­å¿ƒ - è…¾è®¯äº‘ (tencent.com)](https://cloud.tencent.com/document/product/1081)

3. Githubï¼š[iot-device-java](https://github.com/tencentyun/iot-device-java)

4. [æ ‘è“æ´¾4çš„GPIOæ¥å£ä»‹ç» â€“ å…«è‰²æœ¨ (basemu.com)](https://www.basemu.com/raspberry-pi-4-gpio-pinout.html)

5. [æ ‘è“æ´¾---JAVAæ“ä½œGPIO](https://www.jianshu.com/p/0584f8b01725)

   

   

   